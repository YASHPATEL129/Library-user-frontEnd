<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Sign In</title>
    <link
      href="https://fonts.googleapis.com/css2?family=Nunito+Sans:wght@300;400;600;700;800;900&display=swap"
      s
      rel="stylesheet"
    />

    <!-- Css Styles -->
    <link rel="stylesheet" href="css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="css/font-awesome.min.css" type="text/css" />
    <link rel="stylesheet" href="css/elegant-icons.css" type="text/css" />
    <link rel="stylesheet" href="css/magnific-popup.css" type="text/css" />
    <link rel="stylesheet" href="css/nice-select.css" type="text/css" />
    <link rel="stylesheet" href="css/owl.carousel.min.css" type="text/css" />
    <link rel="stylesheet" href="css/slicknav.min.css" type="text/css" />
    <link rel="stylesheet" href="css/style.css" type="text/css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.css"
    />
  </head>
  <body>
    <!-- Page Preloder -->
    <div id="preloder">
      <div class="loader"></div>
    </div>

    <!-- Login 8 - Bootstrap Brain Component -->
    <section
      class="bg-light p-3 p-md-4 p-xl-5"
      style="padding: 22px !important ; background-color: white !important"
    >
      <div class="container">
        <div class="row justify-content-center">
          <div class="col-12 col-xxl-11">
            <div class="card border-light-subtle" style="border-style: none">
              <div class="row g-0">
                <div class="col-12 col-md-6">
                  <img
                    class="img-fluid rounded-start w-100 h-100 object-fit-cover"
                    loading="lazy"
                    src="image/welcome-page.jpg"
                    alt="Welcome back you've been missed!"
                    style="border-radius: 0px 61px 0px 61px"
                  />
                </div>
                <div
                  class="col-12 col-md-6 d-flex align-items-center justify-content-center"
                >
                  <div class="col-12 col-lg-11 col-xl-10">
                    <div
                      class="card-body p-3 p-md-4 p-xl-5"
                      style="padding-top: 0px !important"
                    >
                      <div class="row">
                        <div class="col-10">
                          <div class="mb-5">
                            <div
                              class="text-center mb-15"
                              style="margin-top: -40px; height: 157px"
                            >
                              <img
                                src="image/logo1.png"
                                alt="BootstrapBrain Logo"
                              />
                            </div>
                            <h4 class="text-center" style="margin-top: -20px">
                              Welcome back
                            </h4>
                          </div>
                        </div>
                      </div>

                      <form id="login-form">
                        <div class="row gy-3 overflow-hidden">
                          <div class="col-12">
                            <div class="form-floating mb-3">
                              <label for="email" class="form-label"
                                >Email</label
                              >
                              <input
                                type="email"
                                class="form-control"
                                name="email"
                                id="email"
                                placeholder="name@example.com"
                                required
                              />
                            </div>
                          </div>
                          <div class="col-12">
                            <div class="form-floating mb-3">
                              <label for="password" class="form-label"
                                >Password</label
                              >
                              <input
                                type="password"
                                class="form-control"
                                name="password"
                                id="password"
                                value=""
                                placeholder="Password"
                                required
                              />
                            </div>
                          </div>

                          <div class="col-12">
                            <div class="d-grid">
                              <button class="login-button" type="submit">
                                Log in
                              </button>
                            </div>
                          </div>
                        </div>
                      </form>
                      <div class="row">
                        <div class="col-12">
                          <div
                            class="d-flex gap-2 gap-md-4 flex-column flex-md-row justify-content-md-center mt-5"
                          >
                            <a
                              href="/signup"
                              class="link-secondary text-decoration-none"
                              >Create new account</a
                            >
                            <a
                              id="forgetPasswordBtn"
                              class="link-secondary text-decoration-none"
                              style="margin-left: 61px; cursor: pointer"
                              >Forgot password ?</a
                            >
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
    <!-- Modal -->
    <!-- Your modal code -->
    <div
      class="modal fade"
      id="forgetPasswordModal"
      tabindex="-1"
      aria-labelledby="forgotPasswordModalLabel"
      aria-hidden="true"
    >
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="forgotPasswordModalLabel">
              Forgot Password
            </h5>
          </div>
          <div class="modal-body">
            <form id="forgotPasswordForm">
              <div class="mb-3">
                <label for="email" class="form-label">Email address</label>
                <input
                  type="email"
                  class="form-control"
                  id="forgetemail"
                  aria-describedby="emailHelp"
                  required
                />
              </div>
              <button
                type="button"
                class="btn btn-primary"
                id="sendInstructionsBtn"
              >
                Send otp
              </button>
              <div id="passwordCodeFields" style="display: none">
                <div class="mb-3">
                  <label for="code" class="form-label">Verification Code</label>
                  <input type="text" class="form-control" id="code" required />
                </div>
                <div class="mb-3">
                  <label for="newPassword" class="form-label"
                    >New Password</label
                  >
                  <input
                    type="password"
                    class="form-control"
                    id="newPassword"
                    required
                  />
                </div>
                <div class="mb-3">
                  <label for="confirmPassword" class="form-label"
                    >Confirm Password</label
                  >
                  <input
                    type="password"
                    class="form-control"
                    id="confirmPassword"
                    required
                  />
                </div>
                <button type="button" class="btn btn-primary" id="confirmBtn">
                  Confirm
                </button>
                <button
                  type="button"
                  class="btn btn-secondary"
                  data-dismiss="modal"
                >
                  Close
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Js Plugins -->
    <script src="js/jquery-3.3.1.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/jquery.nice-select.min.js"></script>
    <script src="js/jquery.nicescroll.min.js"></script>
    <script src="js/jquery.magnific-popup.min.js"></script>
    <script src="js/jquery.countdown.min.js"></script>
    <script src="js/jquery.slicknav.js"></script>
    <script src="js/mixitup.min.js"></script>
    <script src="js/owl.carousel.min.js"></script>
    <script src="js/main.js"></script>
    <script src="js/signIn.js"></script>
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Add event listener to the "Send OTP" button
        document
          .getElementById("forgetPasswordBtn")
          .addEventListener("click", function () {
            // Open the modal using jQuery
            $("#forgetPasswordModal").modal("show");
          });

        // Add event listener to the "Confirm" button
        document
          .getElementById("confirmBtn")
          .addEventListener("click", function () {
            const email = document.getElementById("forgetemail").value.trim();
            const newPassword = document.getElementById("newPassword").value;
            const code = document.getElementById("code").value;
            const confirmPassword =
              document.getElementById("confirmPassword").value;

            if (newPassword !== confirmPassword) {
              toastr.error("Passwords do not match.");
              return;
            }
            // Perform an AJAX request to send the new password and verification code to the server
            $.ajax({
              url: "/resetPassword", // Replace with your server endpoint
              method: "POST",
              dataType: "json",
              data: JSON.stringify({
                email: email,
                password: newPassword,
                code: code,
              }), // Send form data as JSON string
              contentType: "application/json",
              success: function (data, status) {
                if (status) {
                  $("#forgetPasswordModal").modal("hide");
                  toastr.success("Password forget successfully");
                }
              },
              error: function (xhr, status, error) {
                // Handle error response from the server
                console.error("Error resetting password:", error);
                // Optionally, display an error message to the user
              },
            });

            // You can also perform AJAX request here to send the new password and code to the server for processing
          });

        // Add event listener to the "Send OTP" button inside the modal
        document
          .getElementById("sendInstructionsBtn")
          .addEventListener("click", function () {
            // Get the email entered by the user
            const email = document.getElementById("forgetemail").value.trim();

            // Check if email is empty
            if (!email) {
              // Display an error message or alert to the user
              toastr.error("Email is required.");
              return;
            }

            // Make an AJAX call to your API endpoint to send the OTP
            $.ajax({
              url: "/send-email-code",
              method: "POST",
              dataType: "json",
              data: JSON.stringify({ email: email }), // Send form data as JSON string
              contentType: "application/json",
              success: function (data, status, jqXHR) {
                console.log(email);
                if (status) {
                  // Show the "New Password" and "Verification Code" fields
                  document.getElementById("passwordCodeFields").style.display =
                    "block";
                  document.getElementById("forgetemail").disabled = true;
                  toastr.success("Email is send");
                }
              },
              error: function (xhr, status, error) {
                console.error("Error sending OTP:", error);
                // Handle error (e.g., display error message to the user)
              },
            });
          });
      });
    </script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/toastr.js/latest/toastr.min.js"></script>
  </body>
</html>
